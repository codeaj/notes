function showLoading(e,t,n){for(var r=0;r<t.length;r++){e[t[r]]=true}for(var r=0;r<n.length;r++){e[n[r]]=false}var i=document.getElementsByTagName("body")[0];var s=i.clientWidth;var o=getDocHeight();var u=document.createElement("div");u.id="progress_div";u.className="ws-in-progress";var a=document.createElement("span");a.id="progress_div_child";a.className="ajax-load";a.innerHTML="Please Wait";u.appendChild(a);i.appendChild(u);angular.element(document.getElementById("progress_div")).css({height:o+"px",width:s+"px"});var f=document.getElementById("progress_div_child");var l={top:o/2-f.clientHeight+"px",left:s/2-f.clientWidth/2+"px"};angular.element(f).css(l)}function getDocHeight(){var e=document;return Math.max(e.body.offsetHeight,e.documentElement.offsetHeight,e.body.clientHeight,e.documentElement.clientHeight)}function hideLoading(){angular.element(document.querySelectorAll("#progress_div")).remove()}function isWeakPassword(e){var t=["Very Weak","Weak","Better","Medium","Strong","Strongest"];var n=0;if(typeof e==="undefined")return false;if(e.length>5)n++;if(e.match(/[a-z]/)&&e.match(/[A-Z]/))n++;if(e.match(/\d+/))n++;if(e.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/))n++;if(e.length>12)n++;return n>3?false:true}function showHideGame(e,t,n){for(var r=0;r<t.length;r++){e[t[r]]=true}for(var r=0;r<n.length;r++){e[n[r]]=false}}function resetObjectKeysToEmpty(e){_.each(_.keys(e),function(t){e[t]=""});return e}function getStringData(e){var t="";_.each(_.keys(e),function(n){t=t+n+"="+e[n]+"&"});return t}function showAppMessage(e,t,n){e.appMessageDisp=true;e.appMessage=t;e.appMessageErr=!n;e.appMessageSuccess=n}function hideAppMessage(e){e.appMessageDisp=false;e.appMessage=""}function resetActivationKeys(){keySet={resetKey:false,activateUser:false,notSet:false};key=false}function logoutIfAuthSet(e,t){if(e.defaults.headers.common["Authorization"]){e.defaults.headers.common["Authorization"]="";t.url("/logout")}else{return}}function loginIfAuthNotSet(e,t){var n=e.defaults.headers.common["Authorization"];if(typeof n==="undefined"||n===""){e.defaults.headers.common["Authorization"]="";t.url("/login")}else{return}}function disableButtons(e,t,n){if(n){e.actions[t].delete=true;for(var r=0;r<e.actions.length;r++){e.actions[r].disabled=true}e.actionAddDisabled=true;e.deleteDialogDisp=true}else{e.actions[t].delete=false;for(var r=0;r<e.actions.length;r++){e.actions[r].disabled=false}e.actionAddDisabled=false;e.deleteDialogDisp=false}}function logout(e,t){e.defaults.headers.common["Authorization"]="";t.url("/logout")}function loginRedirect(e,t){e.defaults.headers.common["Authorization"]="";t.url("/login")}var APP_ROOT="http://jaagar.org/quotes/";var SERVICE_ROOT="v1.2/";var configs={};configs["REGISTER_VALIDATION_NAME"]="Name should be atleast 5 characters long.";configs["ACCOUNT_NOT_ACTIVE"]="The account is still not active, please check your email to activate.";configs["LOGIN_FAIL"]="Login Failed, please try again.";configs["RESET_EMAIL_SENT"]="The email is sent to the given email ID, provided it was found in our database.";configs["REGISTER_SUCCESS"]="Registered Successfully. Please check your email to activate the account.";configs["REGISTER_FAILURE"]="We are facing a technical issue in creating your account, please try again after some time.";configs["USER_ALREADY_VERIFIED"]="User is already verified please login.";configs["USER_VERIFIED"]="Verification complete please login.";configs["USER_VERIFICATION_ERR"]="There was an error in email verification.";configs["PASSWORD_RESET"]="Please enter your new password to reset.";configs["PASSWORD_RESET_USED"]="The reset link is either used or a new link has been requested.";configs["PASSWORD_CHANGED"]="The password has been changed please login with your new credentials.";configs["PASSWORD_CHANGE_FAIL"]="The password change link seems to have expired.";configs["REGISTER_VALIDATION_NAME"]="Name should be atleast 4 character long and without special characters.";configs["REGISTER_VALIDATION_EMAIL"]="Invalid Email Id.";configs["REGISTER_VALIDATION_PASSWORD"]="Use strong password that contains at least 6 characters, a special character, a number and a capital letter.";configs["REGISTER_VALIDATION_CAPTCHA"]="Your entered captcha was wrong please re-enter.";configs["REGISTER_LOGIN"]="Login to the application, if email verification is complete.";configs["EMAIL_VERIFY_SENT"]="Verification email is sent to your email Id";configs["EMAIL_VERIFY_SENT_FAIL"]="There was an error in sending out verification email, please try after some time";configs["CTG_NAME_LENGTH_ERR"]="Category name should be atleast 5 character long.";configs["CTG_DESC_LENGTH_ERR"]="Category description should be atleast 30 character long.";configs["INVALID_EMAIL_ERR"]="Please Enter a valid email Id.";configs["LOGIN_PSWD_REQUIRED"]="Password is required.";configs["LOGOUT_MESSAGE"]="You are successfully logged out of the application.";configs["QUOTE_LENGTH_ERR"]="Quote should be atleast atleast 30 character long.";configs["PASSWORD_NO_MATCH"]="Password do not match.";configs["DATA_NOT_FOUND"]="Error in fetching categories";configs["DELETE_ERROR"]="Requested resource could not be deleted.";configs["UPDATE_ERROR"]="Requested resource could not be updated.";configs["CREATE_ERROR"]="Requested resource could not be created.";configs["SERVICE_ERROR"]="A service error has occurred please try after some time.";var myApp=angular.module("myApp",["ngRoute","ngAnimate"]);myApp.config(function(e){e.when("/",{templateUrl:"templates/home.html",controller:"HomeController"}).when("/readQuotes",{templateUrl:"templates/readQuotes.html",controller:"HomeQuotesController"}).when("/login",{templateUrl:"templates/login.html",controller:"LoginController"}).when("/register",{templateUrl:"templates/register.html",controller:"RegisterController"}).when("/redirect",{templateUrl:"templates/redirect.html",controller:"ResetController"}).when("/categories",{templateUrl:"templates/categories.html",controller:"CategoryController"}).when("/logout",{templateUrl:"templates/logout.html",controller:"LogoutController"}).when("/quotes",{templateUrl:"templates/quotes.html",controller:"QuotesController"})});myApp.directive("checkSplChars",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){if(!e.match(/[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/)){r.$setValidity("checkSplChars",true);return e}else{r.$setValidity("checkSplChars",false);return e}})}}});myApp.directive("minChars",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){if(e.length>=30){r.$setValidity("minChars",true);return e}else{r.$setValidity("minChars",false);return e}})}}});myApp.directive("uniqueEmail",function(e){return{restrict:"A",link:function(t,n,r,i){var s=i;n.on("focus",function(){t.$apply(function(){t.emailIdUnique=false;t.emailIdStatusReceived=""})});n.on("focusout",function(){var r=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;if(!r.test(n.val())){return}e({method:"GET",url:SERVICE_ROOT+"userAvailable/"+n.val(),crossDomain:true}).success(function(e,n,r,i){t.emailIdUnique=e.status;t.emailIdStatusReceived=e.message}).error(function(e,n,r,i){t.emailIdUnique=e.status;t.emailIdStatusReceived=e.message})});n.on("dblclick",function(e){});n.on("mousedown",function(){});n.on("click",function(){})}}});myApp.directive("checkStrongPswd",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){if(!isWeakPassword(e)){r.$setValidity("strongPswd",true);return e}else{r.$setValidity("strongPswd",false);return e}})}}});myApp.factory("Data",function(){var e={};return e});myApp.factory("WebServiceHandler",function(e,t){var n=function(n){var r=e.defer();t({method:"POST",url:SERVICE_ROOT+"login",data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var r=function(n){var r=e.defer();t({method:"POST",url:SERVICE_ROOT+"register",data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var i=function(n){var r=e.defer();t({method:"GET",url:SERVICE_ROOT+"forgotPswd/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var s=function(n){var r=e.defer();t({method:"POST",url:SERVICE_ROOT+"forgotPswd",data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var o=function(n){var r=e.defer();t({method:"GET",url:SERVICE_ROOT+"resendEmailInvite/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var u=function(n){var r=e.defer();t({method:"POST",url:SERVICE_ROOT+"category",data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var a=function(){var n=e.defer();t({method:"GET",url:SERVICE_ROOT+"category",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,r,i){n.resolve({status:t,data:e})}).error(function(e,t,r,i){n.reject({status:t,data:e})});return n.promise};var f=function(n,r){var i=e.defer();t({method:"PUT",url:SERVICE_ROOT+"category/"+r,data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,r){i.resolve({status:t,data:e})}).error(function(e,t,n,r){i.reject({status:t,data:e})});return i.promise};var l=function(n){var r=e.defer();t({method:"DELETE",url:SERVICE_ROOT+"category/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var c=function(n,r,i){var s="";if(i==="ctg"){if(r){s="category/like/"+n}else{s="category/unlike/"+n}}else{if(r){s="quote/like/"+n}else{s="quote/unlike/"+n}}var o=e.defer();t({method:"PUT",url:SERVICE_ROOT+s,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,r){o.resolve({status:t,data:e})}).error(function(e,t,n,r){o.reject({status:t,data:e})});return o.promise};var h=function(n){var r=e.defer();t({method:"GET",url:SERVICE_ROOT+"quote/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var p=function(n){var r=e.defer();t({method:"POST",url:SERVICE_ROOT+"quote",data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var d=function(n,r){var i=e.defer();t({method:"PUT",url:SERVICE_ROOT+"quote/"+r,data:getStringData(n),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,r){i.resolve({status:t,data:e})}).error(function(e,t,n,r){i.reject({status:t,data:e})});return i.promise};var v=function(n){var r=e.defer();t({method:"DELETE",url:SERVICE_ROOT+"quote/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var m=function(n){var r=e.defer();t({method:"GET",url:SERVICE_ROOT+"readCategory",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};var g=function(n){var r=e.defer();t({method:"GET",url:SERVICE_ROOT+"readQuote/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"*/*","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){r.resolve({status:t,data:e})}).error(function(e,t,n,i){r.reject({status:t,data:e})});return r.promise};return{register:r,login:n,sendReset:i,resetPswd:s,resendVerifyInvite:o,getCategories:a,createCategory:u,deleteCategory:l,updateCategory:f,likeQuoteOrCtg:c,getQuotes:h,createQuote:p,updateQuote:d,deleteQuote:v,getReadCategories:m,getReadQuotes:g}});myApp.controller("ParentController",function(e,t){e.headerTitle="Inspirational Quotes";e.singleQuote="“There are only two ways to live your life. One is as though nothing is a miracle. The other is as though everything is a miracle.”";e.singleQuoteAuthor="― Albert Einstein";if(!keySet.notSet){t.url("/redirect")}else{resetActivationKeys()}});myApp.controller("RegisterController",function(e,t,n,r){logoutIfAuthSet(n,r);hideAppMessage(e);showHideGame(e,["registerFormDisp"],["appMessageDisp","register_success","emailIdUnique"]);_.extend(e,configs);e.emailIdStatusReceived="";if(typeof Recaptcha==="undefined"){var i=document.createElement("script");i.setAttribute("src","http://www.google.com/recaptcha/api/js/recaptcha_ajax.js");document.head.appendChild(i);i.onload=function(){Recaptcha.create("6LcyZfMSAAAAAHxXTKjVqC2G6qike2rUDjQhj5rC","captcha-container",{theme:"white",callback:Recaptcha.focus_response_field})}}else{Recaptcha.create("6LcyZfMSAAAAAHxXTKjVqC2G6qike2rUDjQhj5rC","captcha-container",{theme:"white",callback:Recaptcha.focus_response_field})}e.loginRedirect=function(){loginRedirect(n,r)};e.loginRedirect=function(){r.url("/login")};e.register=function(n){hideAppMessage(e);showLoading(e,[],["appMessageDisp"]);t.register({name:n.name,email:n.emailId,password:pidCrypt.MD5(n.password),recaptcha_challenge_field:Recaptcha.get_challenge(),recaptcha_response_field:Recaptcha.get_response()}).then(function(t){if(t.status===201){showAppMessage(e,e.REGISTER_SUCCESS,true);showHideGame(e,["register_success"],["captchaError","registerFormDisp"])}else{showAppMessage(e,e.REGISTER_FAILURE,false);showHideGame(e,["register_success"],["captchaError","registerFormDisp"])}hideLoading()},function(t){if(t.status===400&&(t.data.message==="captcha is not valid"||t.data.message==="Required field(s) recaptcha_response_field is missing or empty")){Recaptcha.reload();e.captchaError=true}else{showAppMessage(e,e.REGISTER_FAILURE,false);showHideGame(e,["registerFormDisp"],["captchaError"]);e.loginForm.$setPristine(true);e.user=resetObjectKeysToEmpty(n)}hideLoading()})}});myApp.controller("LoginController",function(e,t,n,r){_.extend(e,configs);logoutIfAuthSet(n,r);hideAppMessage(e);showHideGame(e,["loginFormDisp"],["resetSendEmailDisp"]);e.login=function(i){hideAppMessage(e);var s=i.emailId;showLoading(e,[],["appMessageDisp"]);t.login({email:i.emailId,password:pidCrypt.MD5(i.password)}).then(function(t){if(t.status===200){n.defaults.headers.common["Authorization"]=t.data.api_key;r.url("/categories")}else if(t.status===202){showAppMessage(e,e.ACCOUNT_NOT_ACTIVE,false);e.loginForm.$setPristine(true);e.user=resetObjectKeysToEmpty(i);e.resendVerifyInviteDisp=true;e.resetEmailId=s}hideLoading()},function(){showAppMessage(e,e.LOGIN_FAIL,false);e.loginForm.$setPristine(true);e.user=resetObjectKeysToEmpty(i);hideLoading()})};e.showForgotPswd=function(){hideAppMessage(e);showHideGame(e,["resetSendEmailDisp"],["appMessageDisp","loginFormDisp"])};e.resetSendEmail=function(n){hideAppMessage(e);showLoading(e,[],["appMessageDisp"]);t.sendReset(n).then(function(){showAppMessage(e,e.RESET_EMAIL_SENT,true);showHideGame(e,["loginFormDisp"],["resetSendEmailDisp"]);e.resetSendEmailForm.$setPristine(true);e.resetEmail="";hideLoading()},function(){showAppMessage(e,e.RESET_EMAIL_SENT,true);showHideGame(e,["loginFormDisp"],["resetSendEmailDisp"]);e.resetSendEmailForm.$setPristine(true);e.resetEmail="";hideLoading()})};e.resendVerifyInvite=function(){hideAppMessage(e);var n=e.resetEmailId;showLoading(e,[],["appMessageDisp"]);t.resendVerifyInvite(n).then(function(t){console.log(t);showAppMessage(e,e.EMAIL_VERIFY_SENT,true);showHideGame(e,["resendVerifyInviteResponseDisp"],["resendVerifyInviteDisp"]);hideLoading()},function(t){console.log(t);showAppMessage(e,e.EMAIL_VERIFY_SENT_FAIL,false);showHideGame(e,["resendVerifyInviteResponseDisp"],["resendVerifyInviteDisp"]);hideLoading()})}});myApp.controller("ResetController",function(e,t,n,r){_.extend(e,configs);logoutIfAuthSet(n,r);if(keySet.resetKey){if(key!=="false"){showAppMessage(e,e.PASSWORD_RESET,true);e.resetPswdObj={resetKey:key.split("***")[0],email:key.split("***")[1]};showHideGame(e,["resetFormDisp"],["reset_success"]);e.password_changed=e.PASSWORD_CHANGED}else{showAppMessage(e,e.PASSWORD_RESET_USED,false);showHideGame(e,["reset_success"],["resetFormDisp"]);e.password_changed="Reset link seems expired. Please request it again."}}else if(keySet.activateUser){if(key==="200"){showAppMessage(e,e.USER_VERIFIED,true)}else if(key==="203"){showAppMessage(e,e.USER_ALREADY_VERIFIED,true)}else{showAppMessage(e,e.USER_VERIFICATION_ERR,false)}showHideGame(e,["reset_success"],["resetFormDisp"]);e.password_changed="Please login."}else{hideAppMessage(e);showHideGame(e,["reset_success"],["resetFormDisp"]);e.password_changed="Please login."}e.loginRedirect=function(){loginRedirect(n,r)};e.resetPswd=function(n){hideAppMessage(e.$parent,true);showLoading(e,[],["appMessageDisp"]);var r=n.newPassword;n.newPassword=pidCrypt.MD5(r);n.repeatPassword=pidCrypt.MD5(r);t.resetPswd(n).then(function(){showHideGame(e,["reset_success"],["resetFormDisp"]);showAppMessage(e,e.PASSWORD_CHANGED,true);e.resetForm.$setPristine(true);e.user=resetObjectKeysToEmpty(n);hideLoading()},function(){showHideGame(e,["reset_success"],["resetFormDisp"]);showAppMessage(e,e.PASSWORD_CHANGE_FAIL,false);e.password_changed="Login to the application.";e.resetForm.$setPristine(true);e.user=resetObjectKeysToEmpty(n);hideLoading()})}});myApp.controller("LogoutController",function(e,t,n){e.loginRedirect=function(){loginRedirect(t,n)};_.extend(e,configs);logoutIfAuthSet(t,n)});myApp.controller("CategoryController",function(e,t,n,r,i){_.extend(e,configs);loginIfAuthNotSet(i,r);e.categories=[];e.actions=[];t.getCategories().then(function(t){var r=t.data.message;e.categories=r;n.categories=e.categories;for(var i=0;i<e.categories.length;i++){e.actions.push({"delete":false,disabled:false})}hideLoading()},function(t){showAppMessage(e,e.DATA_NOT_FOUND,false);console.log(t);hideLoading()});e.actionAddDisabled=false;e.editModel={ctgId:"",name:"",description:""};e.deleteIndex=-1;e.editIndex=-1;showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"]);e.logout=function(){logout(i,r)};e.likeCategory=function(r){hideAppMessage(e);var i=false;if(!e.categories[r].liked){i=true}showLoading(e,[],["appMessageDisp"]);t.likeQuoteOrCtg(e.categories[r].id,i,"ctg").then(function(t){if(t.data.message){e.categories[r].liked=!e.categories[r].liked;e.categories[r].likes=t.data.message.count;n.categories=e.categories}hideLoading()},function(){showAppMessage(e,e.SERVICE_ERROR,false);hideLoading()})};e.editCategory=function(t){hideAppMessage(e);e.editModel={id:e.categories[t].id,name:e.categories[t].name,description:e.categories[t].description};e.editIndex=t;showHideGame(e,["editCtgDisp"],["ctgDisp","createCtgDisp"])};e.cancelCategoryEdit=function(){showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"]);e.editForm.$setPristine(true)};e.updateCategory=function(r){hideAppMessage(e);showLoading(e,[],["appMessageDisp"]);t.updateCategory({name:r.name,description:r.description},r.id).then(function(t){var r=t.data.message;if(r){e.categories[e.editIndex]=r;n.categories=e.categories}e.createForm.$setPristine(true);showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"]);hideLoading()},function(){showAppMessage(e,e.UPDATE_ERROR,false);hideLoading();e.editForm.$setPristine(true);showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"])})};e.deleteCategoryDialog=function(t){hideAppMessage(e);disableButtons(e,t,true);e.deleteIndex=t};e.deleteCtg=function(){hideAppMessage(e);var r=e.categories[e.deleteIndex].id;showLoading(e,[],["appMessageDisp"]);t.deleteCategory(r).then(function(t){var r=t.data.message;if(r){e.categories.splice(e.deleteIndex,1);n.categories=e.categories}e.deleteDialogDisp=false;disableButtons(e,e.deleteIndex,false);e.deleteIndex=-1;hideLoading()},function(){showAppMessage(e,e.DELETE_ERROR,false);hideLoading()})};e.cancelDeleteCtg=function(){hideAppMessage(e);e.deleteDialogDisp=false;disableButtons(e,e.deleteIndex,false);e.deleteIndex=-1};e.addCategoryDialog=function(){hideAppMessage(e);showHideGame(e,["createCtgDisp"],["ctgDisp","editCtgDisp"])};e.cancelCategoryCreate=function(){hideAppMessage(e);e.createForm.$setPristine(true);showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"])};e.createCategory=function(r){hideAppMessage(e);var i={name:r.name,description:r.description};showLoading(e,[],["appMessageDisp"]);t.createCategory(i).then(function(t){var r=t.data.message;console.log(r);e.categories.unshift(r);n.categories=e.categories;e.actions.push({"delete":false,disabled:false});e.createForm.$setPristine(true);showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"]);hideLoading()},function(){showAppMessage(e,e.CREATE_ERROR,false);e.createForm.$setPristine(true);showHideGame(e,["ctgDisp"],["editCtgDisp","createCtgDisp"]);hideLoading()})};e.displayQuotes=function(t){hideAppMessage(e);n.categorySelected={id:e.categories[t].id,index:t};n.categories=e.categories;r.url("/quotes")}});myApp.controller("QuotesController",function(e,t,n,r,i){_.extend(e,configs);loginIfAuthNotSet(i,r);if(typeof n.categorySelected=="undefined"){r.url("/categories");n.categorySelected=undefined;return}var s=n.categorySelected.id;e.headerTitle=n.categories[n.categorySelected.index].name;e.quotes=[];e.actions=[];showLoading(e,[],["appMessageDisp"]);t.getQuotes(s).then(function(t){e.quotes=t.data.message;n.quotes=e.quotes;for(var r=0;r<e.quotes.length;r++){e.actions.push({"delete":false,disabled:false})}hideLoading()},function(e){console.log(e);hideLoading()});e.actionAddDisabled=false;e.editModel={id:"",description:""};e.deleteIndex=-1;e.editIndex=-1;e.editModel=resetObjectKeysToEmpty(e.editModel);showHideGame(e,["quotesDisp"],["createQuotesDisp","editQuotesDisp"]);e.backToCtg=function(){r.url("/categories")};e.logout=function(){logout(i,r)};e.likeQuote=function(r){hideAppMessage(e);var i=false;if(!e.quotes[r].liked){i=true}showLoading(e,[],["appMessageDisp"]);t.likeQuoteOrCtg(e.quotes[r].id,i,"quote").then(function(t){if(t.data.message){e.quotes[r].liked=!e.quotes[r].liked;e.quotes[r].likes=t.data.message.count;n.quotes=e.quotes}hideLoading()},function(){showAppMessage(e,e.SERVICE_ERROR,false);hideLoading()})};e.addQuoteDialog=function(){hideAppMessage(e);showHideGame(e,["createQuotesDisp"],["quotesDisp","editQuotesDisp"])};e.cancelQuoteCreate=function(t){hideAppMessage(e);e.createModel=resetObjectKeysToEmpty(t);e.createForm.$setPristine(true);showHideGame(e,["quotesDisp"],["createQuotesDisp","editQuotesDisp"])};e.createQuote=function(r){hideAppMessage(e);var i={quote:r.quote,wrNctg_ref:s};showLoading(e,[],["appMessageDisp"]);t.createQuote(i).then(function(t){var i=t.data.message;console.log(i);e.quotes.unshift(i);n.quotes=e.quotes;e.actions.push({"delete":false,disabled:false});e.createModel=resetObjectKeysToEmpty(r);e.createForm.$setPristine(true);showHideGame(e,["quotesDisp"],["createQuotesDisp","editQuotesDisp"]);hideLoading()},function(){showAppMessage(e,e.CREATE_ERROR,false);showHideGame(e,["quotesDisp"],["createQuotesDisp","editQuotesDisp"]);hideLoading()})};e.editQuote=function(t){hideAppMessage(e);e.editModel={quoteId:e.quotes[t].id,quote:e.quotes[t].text};e.editIndex=t;showHideGame(e,["editQuotesDisp"],["quotesDisp","createQuotesDisp"])};e.updateQuote=function(r){hideAppMessage(e);showLoading(e,[],["appMessageDisp"]);t.updateQuote({quote:r.quote},r.quoteId).then(function(t){var r=t.data.message;if(r){e.quotes[e.editIndex]=r;n.quotes=e.quotes}e.createForm.$setPristine(true);showHideGame(e,["quotesDisp"],["createQuotesDisp","editQuotesDisp"]);hideLoading()},function(){showAppMessage(e,e.UPDATE_ERROR,false);hideLoading();e.editForm.$setPristine(true);showHideGame(e,["quotesDisp"],["createQuotesDisp","editQuotesDisp"])})};e.cancelQuoteEdit=function(){hideAppMessage(e);e.editForm.$setPristine(true);showHideGame(e,["quotesDisp"],["editQuotesDisp","createQuotesDisp"])};e.deleteQuoteDialog=function(t){hideAppMessage(e);disableButtons(e,t,true);e.deleteIndex=t};e.deleteQuote=function(){hideAppMessage(e);var r=e.quotes[e.deleteIndex].id;showLoading(e,[],["appMessageDisp"]);t.deleteQuote(r).then(function(t){var r=t.data.message;if(r){e.quotes.splice(e.deleteIndex,1);n.quotes=e.quotes}disableButtons(e,e.deleteIndex,false);e.deleteIndex=-1;hideLoading()},function(){showAppMessage(e,e.DELETE_ERROR,false);disableButtons(e,e.deleteIndex,false);e.deleteIndex=-1;hideLoading()})};e.cancelDeleteQuote=function(){hideAppMessage(e);disableButtons(e,e.deleteIndex,false);e.deleteIndex=-1}});myApp.controller("HomeController",function(e,t,n,r,i){logoutIfAuthSet(n,r);e.readCategories=[];showLoading(e,[],[]);t.getReadCategories().then(function(t){if(t.data){e.readCategories=t.data}hideLoading()},function(){hideLoading()});e.displayQuotes=function(t){i.readCategorySelected={id:e.readCategories[t].id,index:t};i.readCategories=e.readCategories;r.url("/readQuotes")};e.loginRedirect=function(){loginRedirect(n,r)}});myApp.controller("HomeQuotesController",function(e,t,n,r,i){logoutIfAuthSet(n,r);e.readQuotes=[];if(typeof i.readCategorySelected=="undefined"){r.url("/");i.readCategorySelected=undefined;return}var s=i.readCategorySelected.id;e.headerTitle=i.readCategories[i.readCategorySelected.index].name;e.quotes=[];showLoading(e,[],[]);t.getReadQuotes(s).then(function(t){e.readQuotes=t.data;i.quotes=e.readQuotes;hideLoading()},function(){hideLoading()});e.loginRedirect=function(){loginRedirect(n,r)};e.backToReadCtgs=function(){r.url("/")}})